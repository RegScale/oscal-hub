# ==============================================================================
# OSCAL Tools - Environment Variables Template
# ==============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control (already in .gitignore)
# ==============================================================================

# ------------------------------------------------------------------------------
# Spring Profile Configuration
# ------------------------------------------------------------------------------
# Options: dev, staging, prod
# Default: dev (if not specified)
SPRING_PROFILES_ACTIVE=dev

# ------------------------------------------------------------------------------
# Server Configuration
# ------------------------------------------------------------------------------
SERVER_PORT=8080

# ------------------------------------------------------------------------------
# Database Configuration
# ------------------------------------------------------------------------------
# For Development (H2 in-memory/file-based)
DB_URL=jdbc:h2:file:./data/oscal-history
DB_DRIVER=org.h2.Driver
DB_USERNAME=sa
DB_PASSWORD=

# For Production (PostgreSQL - recommended)
# DB_URL=jdbc:postgresql://localhost:5432/oscal_db
# DB_DRIVER=org.postgresql.Driver
# DB_USERNAME=oscal_user
# DB_PASSWORD=your-secure-database-password-here
# DB_DIALECT=org.hibernate.dialect.PostgreSQLDialect

# Database Connection Pool (Production)
# DB_POOL_SIZE=10
# DB_POOL_MIN_IDLE=2
# DB_CONNECTION_TIMEOUT=30000
# DB_IDLE_TIMEOUT=600000
# DB_MAX_LIFETIME=1800000

# Database Schema Management
# DB_DDL_AUTO=update   # dev/staging
# DB_DDL_AUTO=validate # production

# H2 Console (Development only)
H2_CONSOLE_ENABLED=true

# ------------------------------------------------------------------------------
# JWT Authentication Configuration
# ------------------------------------------------------------------------------
# CRITICAL: Generate a secure random secret for production
# Minimum 256 bits (32+ characters) required
#
# To generate a secure secret, run:
#   openssl rand -base64 64 | tr -d '\n' | head -c 64
#
# DEVELOPMENT (insecure - for development only):
JWT_SECRET=dev-secret-key-only-for-development-do-not-use-in-production-minimum-256-bits

# PRODUCTION (replace with your generated secret):
# JWT_SECRET=your-super-secure-jwt-secret-minimum-256-bits-generated-with-openssl

# JWT token expiration in milliseconds
# 3600000 = 1 hour
# 86400000 = 24 hours
JWT_EXPIRATION=3600000

# ------------------------------------------------------------------------------
# CORS Configuration
# ------------------------------------------------------------------------------
# Development: Allow localhost
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# Production: Specify your production domains (comma-separated)
# CORS_ALLOWED_ORIGINS=https://oscal-tools.example.com,https://www.oscal-tools.example.com

CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Authorization,Content-Type
CORS_ALLOW_CREDENTIALS=true

# ------------------------------------------------------------------------------
# File Upload Configuration
# ------------------------------------------------------------------------------
MAX_FILE_SIZE=10MB
MAX_REQUEST_SIZE=10MB

# ------------------------------------------------------------------------------
# File Validation Configuration
# ------------------------------------------------------------------------------
# Security: Validates uploaded files to prevent malicious uploads
# Maximum file size for OSCAL documents (in bytes)
# 10485760 = 10MB
FILE_VALIDATION_MAX_SIZE=10485760

# Maximum size for Base64-encoded logos (in bytes)
# 2097152 = 2MB (Base64 increases size by ~33%, so 2MB encoded â‰ˆ 1.5MB original)
FILE_VALIDATION_MAX_LOGO_SIZE=2097152

# Enable magic number (file signature) validation
# Prevents MIME type spoofing by checking actual file content
FILE_VALIDATION_MAGIC_NUMBER=true

# Enable virus scanning integration (requires external service)
FILE_VALIDATION_VIRUS_SCAN=false

# Virus scanning service URL (if enabled)
# Example: http://localhost:3310/scan (ClamAV REST API)
FILE_VALIDATION_VIRUS_SCAN_URL=

# ------------------------------------------------------------------------------
# Azure Blob Storage Configuration (Optional)
# ------------------------------------------------------------------------------
# If using Azure Blob Storage for file persistence
# Leave empty to use local filesystem
#
# Connection string format:
# DefaultEndpointsProtocol=https;AccountName=ACCOUNT_NAME;AccountKey=ACCOUNT_KEY;EndpointSuffix=core.windows.net
AZURE_STORAGE_CONNECTION_STRING=

# Container names (customize for your deployment)
AZURE_STORAGE_CONTAINER_NAME=oscal-files
AZURE_STORAGE_LIBRARY_CONTAINER_NAME=oscal-library
AZURE_STORAGE_BUILD_CONTAINER_NAME=oscal-build-storage
AZURE_STORAGE_BUILD_FOLDER=build

# ------------------------------------------------------------------------------
# Logging Configuration
# ------------------------------------------------------------------------------
# Log levels: TRACE, DEBUG, INFO, WARN, ERROR
LOG_LEVEL_ROOT=INFO
LOG_LEVEL_OSCAL=DEBUG

# Production log file path (optional)
# LOG_FILE_PATH=/var/log/oscal-tools/application.log

# ------------------------------------------------------------------------------
# Security Headers Configuration
# ------------------------------------------------------------------------------
# Enable comprehensive security headers
SECURITY_HEADERS_ENABLED=false  # true in production
SECURITY_REQUIRE_HTTPS=false    # true in production

# HSTS (HTTP Strict Transport Security)
HSTS_MAX_AGE=31536000           # 1 year in seconds
HSTS_PRELOAD=false              # Set to true for HSTS preload list

# Content Security Policy (CSP)
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self'
CSP_STYLE_SRC='self' 'unsafe-inline'
CSP_IMG_SRC='self' data: https:
CSP_CONNECT_SRC='self'

# Frame Options
FRAME_OPTIONS_POLICY=DENY       # DENY, SAMEORIGIN

# Referrer Policy
REFERRER_POLICY=strict-origin-when-cross-origin

# ------------------------------------------------------------------------------
# Rate Limiting Configuration
# ------------------------------------------------------------------------------
# Enable rate limiting to prevent brute force attacks and API abuse
RATE_LIMIT_ENABLED=false  # true in production

# Login rate limiting (per IP address)
RATE_LIMIT_LOGIN_ATTEMPTS=5           # Max login attempts
RATE_LIMIT_LOGIN_DURATION=60          # Duration in seconds (60 = 1 minute)

# Registration rate limiting (per IP address)
RATE_LIMIT_REGISTRATION_ATTEMPTS=3    # Max registration attempts
RATE_LIMIT_REGISTRATION_DURATION=3600 # Duration in seconds (3600 = 1 hour)

# API rate limiting (per authenticated user or IP)
RATE_LIMIT_API_REQUESTS=100           # Max API requests
RATE_LIMIT_API_DURATION=60            # Duration in seconds (60 = 1 minute)

# ------------------------------------------------------------------------------
# Account Security Configuration
# ------------------------------------------------------------------------------
# Password Complexity Requirements
PASSWORD_MIN_LENGTH=10                     # Minimum password length (NIST: 8, OWASP: 10)
PASSWORD_MAX_LENGTH=128                    # Maximum password length
PASSWORD_REQUIRE_UPPERCASE=true            # Require uppercase letters
PASSWORD_REQUIRE_LOWERCASE=true            # Require lowercase letters
PASSWORD_REQUIRE_DIGIT=true                # Require digits
PASSWORD_REQUIRE_SPECIAL=true              # Require special characters
PASSWORD_CHECK_COMMON=true                 # Check against common passwords list
PASSWORD_PREVENT_USERNAME=true             # Prevent username in password

# Account Lockout Configuration
ACCOUNT_LOCKOUT_ENABLED=true               # Enable account lockout (true in production)
ACCOUNT_LOCKOUT_MAX_ATTEMPTS=5             # Failed attempts before lockout
ACCOUNT_LOCKOUT_DURATION=900               # Lockout duration in seconds (15 minutes)
ACCOUNT_LOCKOUT_WINDOW=600                 # Time window for counting attempts (10 minutes)
TRACK_LOGIN_BY_IP=true                     # Track login attempts by IP address
IP_LOCKOUT_MAX_ATTEMPTS=10                 # Failed attempts per IP before lockout

# Password Expiration Configuration (Optional)
PASSWORD_EXPIRATION_ENABLED=false          # Enable password expiration
PASSWORD_EXPIRATION_DAYS=90                # Force password change after X days
PASSWORD_EXPIRATION_WARNING_DAYS=14        # Warn user X days before expiration

# Password History Configuration (Optional)
PASSWORD_HISTORY_ENABLED=false             # Prevent password reuse
PASSWORD_HISTORY_COUNT=5                   # Number of previous passwords to remember

# Login Tracking Configuration
TRACK_SUCCESSFUL_LOGINS=true               # Track successful login attempts
TRACK_FAILED_LOGINS=true                   # Track failed login attempts
MAX_LOGIN_HISTORY_ENTRIES=100              # Max login history entries per user

# Email Notifications Configuration (Optional)
EMAIL_NOTIFICATIONS_ENABLED=false          # Enable email notifications
EMAIL_ON_LOCKOUT=false                     # Email user on account lockout
EMAIL_ON_PASSWORD_CHANGE=false             # Email user on password change

# ------------------------------------------------------------------------------
# Audit Logging Configuration
# ------------------------------------------------------------------------------
# Enable detailed audit logging for security events
AUDIT_LOGGING_ENABLED=false  # true in production

# ------------------------------------------------------------------------------
# Swagger/OpenAPI Configuration
# ------------------------------------------------------------------------------
# Enable Swagger UI and API documentation
SWAGGER_ENABLED=true  # false or require auth in production

# ------------------------------------------------------------------------------
# SSL/TLS Configuration (Production)
# ------------------------------------------------------------------------------
# Uncomment and configure for HTTPS in production
# SERVER_SSL_ENABLED=true
# SSL_KEYSTORE_PATH=/path/to/keystore.p12
# SSL_KEYSTORE_PASSWORD=your-keystore-password
# SSL_KEYSTORE_TYPE=PKCS12
# SSL_KEY_ALIAS=oscal-tools

# ------------------------------------------------------------------------------
# Environment-Specific Examples
# ------------------------------------------------------------------------------

# === DEVELOPMENT EXAMPLE ===
# SPRING_PROFILES_ACTIVE=dev
# DB_PASSWORD=dev-password
# JWT_SECRET=dev-secret-key-only-for-development
# H2_CONSOLE_ENABLED=true
# SWAGGER_ENABLED=true
# SECURITY_HEADERS_ENABLED=false
# RATE_LIMIT_ENABLED=false

# === STAGING EXAMPLE ===
# SPRING_PROFILES_ACTIVE=staging
# DB_URL=jdbc:postgresql://staging-db.example.com:5432/oscal_staging
# DB_USERNAME=oscal_staging_user
# DB_PASSWORD=staging-secure-password-here
# JWT_SECRET=staging-generated-secret-minimum-256-bits
# CORS_ALLOWED_ORIGINS=https://staging.oscal-tools.example.com
# SWAGGER_ENABLED=true
# SECURITY_HEADERS_ENABLED=true
# RATE_LIMIT_ENABLED=true

# === PRODUCTION EXAMPLE ===
# SPRING_PROFILES_ACTIVE=prod
# DB_URL=jdbc:postgresql://prod-db.example.com:5432/oscal_production
# DB_USERNAME=oscal_prod_user
# DB_PASSWORD=production-super-secure-password-here
# JWT_SECRET=production-generated-secret-minimum-256-bits-here
# CORS_ALLOWED_ORIGINS=https://oscal-tools.example.com
# SWAGGER_ENABLED=false
# SECURITY_HEADERS_ENABLED=true
# SECURITY_REQUIRE_HTTPS=true
# RATE_LIMIT_ENABLED=true
# ACCOUNT_LOCKOUT_ENABLED=true
# AUDIT_LOGGING_ENABLED=true
# SERVER_SSL_ENABLED=true

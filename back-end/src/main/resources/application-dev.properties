# Development Environment Configuration
# This profile is for local development only

# Server Configuration
server.port=${SERVER_PORT:8080}

# SSL/TLS Configuration (Optional in development)
server.ssl.enabled=${SSL_ENABLED:false}
server.ssl.key-store=${SSL_KEYSTORE:file:certs/keystore.p12}
server.ssl.key-store-password=${SSL_KEYSTORE_PASSWORD:changeit}
server.ssl.key-store-type=PKCS12
server.ssl.key-alias=${SSL_KEY_ALIAS:oscal-dev}
# HTTP port (when SSL is enabled, this port redirects to HTTPS)
server.http.port=${HTTP_PORT:8080}
server.ssl.redirect-http=${SSL_REDIRECT_HTTP:false}

# CORS Configuration (Permissive for development)
cors.allowed-origins=http://localhost:3000,http://localhost:3001
cors.allowed-methods=GET,POST,PUT,DELETE,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true

# PostgreSQL Database Configuration (Development)
# Uses PostgreSQL running in Docker container
# Start with: docker-compose -f docker-compose-postgres.yml up -d
spring.datasource.url=${DB_URL:jdbc:postgresql://localhost:5432/oscal_dev}
spring.datasource.driverClassName=${DB_DRIVER:org.postgresql.Driver}
spring.datasource.username=${DB_USERNAME:oscal_user}
spring.datasource.password=${DB_PASSWORD:oscal_dev_password}

# PostgreSQL-specific JPA settings
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# Connection Pool Settings (HikariCP - default in Spring Boot)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000

# H2 Console (Disabled - using PostgreSQL)
spring.h2.console.enabled=false

# JWT Configuration
# IMPORTANT: Use environment variable JWT_SECRET for production
# Default development secret (not secure - for development only)
jwt.secret=${JWT_SECRET:dev-secret-key-only-for-development-do-not-use-in-production-minimum-256-bits}
jwt.expiration=${JWT_EXPIRATION:86400000}

# Logging (Verbose for development)
logging.level.root=INFO
logging.level.gov.nist.oscal=DEBUG
logging.level.org.springframework.security=DEBUG

# Swagger/OpenAPI (Enabled without auth in development)
springdoc.swagger-ui.enabled=true
springdoc.api-docs.enabled=true

# File Upload Limits
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Security Headers (Disabled in development)
security.headers.enabled=${SECURITY_HEADERS_ENABLED:false}
security.headers.require-https=false
security.headers.hsts.enabled=false
security.headers.csp.enabled=false
security.headers.frame-options.policy=SAMEORIGIN

# Rate Limiting (Disabled by default in development, enable for testing)
rate.limit.enabled=${RATE_LIMIT_ENABLED:false}
rate.limit.login.attempts=5
rate.limit.login.duration=60
rate.limit.registration.attempts=3
rate.limit.registration.duration=3600
rate.limit.api.requests=100
rate.limit.api.duration=60

# Cloud Storage Configuration
# Storage provider selection: 'azure', 's3', or 'gcs'
# Options:
#   - 'gcs'   - Google Cloud Storage (default for local dev and GCP deployments)
#   - 'azure' - Azure Blob Storage
#   - 's3'    - AWS S3 (for AWS deployments)
storage.provider=${STORAGE_PROVIDER:gcs}

# Azure Blob Storage Configuration (Default for local development)
# Leave connection-string empty to use local file system fallback
azure.storage.connection-string=${AZURE_STORAGE_CONNECTION_STRING:}
azure.storage.container-name=${AZURE_STORAGE_CONTAINER_NAME:oscal-files-dev}
azure.storage.library-container-name=${AZURE_STORAGE_LIBRARY_CONTAINER_NAME:oscal-library-dev}
azure.storage.build-container-name=${AZURE_STORAGE_BUILD_CONTAINER_NAME:oscal-build-storage-dev}
azure.storage.build-folder=${AZURE_STORAGE_BUILD_FOLDER:build}

# AWS S3 Configuration (Used when storage.provider=s3)
# For AWS deployments with Elastic Beanstalk
# Authentication uses IAM role (no access keys needed when running on EC2/EB)
aws.s3.region=${AWS_REGION:us-east-1}
aws.s3.bucket-build=${AWS_S3_BUCKET_BUILD:oscal-tools-build-dev}
aws.s3.build-folder=${AWS_S3_BUILD_FOLDER:build}

# Google Cloud Storage Configuration (Used when storage.provider=gcs)
# For GCP local development and Cloud Run deployments
# Authentication uses Application Default Credentials (ADC):
#   - Local dev: gcloud auth application-default login
#   - Cloud Run: Service account automatically configured
gcp.project-id=${GCP_PROJECT_ID:oscal-hub}
gcp.storage.bucket-build=${GCS_BUCKET_BUILD:oscal-tools-build-dev-us-central1}
gcp.storage.build-folder=${GCS_BUILD_FOLDER:build}

# Local File Storage Fallback
# Used when cloud storage is not configured or fails to initialize
file.upload-dir=${FILE_UPLOAD_DIR:./uploads}

# Actuator Configuration (Development - More Permissive)
# Expose all endpoints for development debugging
management.endpoints.web.exposure.include=*
management.endpoint.health.show-details=always
management.endpoint.health.show-components=always
# Enable additional debug endpoints
management.endpoint.env.enabled=true
management.endpoint.configprops.enabled=true
management.endpoint.beans.enabled=true
management.endpoint.mappings.enabled=true

option_settings:
  # Java Environment Variables
  aws:elasticbeanstalk:application:environment:
    SERVER_PORT: 5000
    SPRING_PROFILES_ACTIVE: prod
    AWS_REGION: us-east-1

  # Java Runtime Options
  aws:elasticbeanstalk:container:java:
    Xmx: 512m
    Xms: 256m
    JVM Options: '-XX:+UseG1GC -XX:MaxGCPauseMillis=200 -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/var/log/heap-dump.hprof'

  # Auto Scaling Configuration
  aws:autoscaling:asg:
    MinSize: 2
    MaxSize: 6
    Cooldown: 360

  # Auto Scaling Triggers
  aws:autoscaling:trigger:
    MeasureName: CPUUtilization
    Statistic: Average
    Unit: Percent
    UpperThreshold: 75
    UpperBreachScaleIncrement: 1
    LowerThreshold: 25
    LowerBreachScaleIncrement: -1
    Period: 5
    BreachDuration: 5

  # Health Check Configuration
  aws:elasticbeanstalk:application:
    Application Healthcheck URL: /actuator/health

  # Load Balancer Configuration
  aws:elbv2:loadbalancer:
    IdleTimeout: 120

  # Instance Configuration
  aws:autoscaling:launchconfiguration:
    InstanceType: t3.medium
    IamInstanceProfile: aws-elasticbeanstalk-ec2-role
    RootVolumeType: gp3
    RootVolumeSize: 20

  # Rolling Updates and Deployments
  aws:elasticbeanstalk:command:
    DeploymentPolicy: Rolling
    BatchSizeType: Percentage
    BatchSize: 50
    Timeout: 600

  # Managed Platform Updates
  aws:elasticbeanstalk:managedactions:
    ManagedActionsEnabled: true
    PreferredStartTime: "Sun:03:00"

  aws:elasticbeanstalk:managedactions:platformupdate:
    UpdateLevel: minor
    InstanceRefreshEnabled: true

  # Enhanced Health Reporting
  aws:elasticbeanstalk:healthreporting:system:
    SystemType: enhanced
